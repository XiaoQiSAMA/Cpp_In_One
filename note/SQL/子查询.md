# 子查询
- 称谓
	- 外查询(主查询)与内查询(子查询)

- 注意
	- 子查询先于主查询执行
	- 子查询需要包含在括号内
	- 子查询通常写在右侧
	- 单行操作符对应单行子查询，多行操作符对应多行子查询
	- 如果不处理，内查询返回NULL时外查询将不会有结果
	- 除GROUP BY和LIMIT外，其他位置都可用子查询

# 分类
- 返回条目数: 单行子查询 / 多行子查询
	- 子查询只返回1个结果，则为单行子查询
	- 返回多个结果，则为多行子查询
- 内查询执行次数: 相关子查询 / 不相关子查询
	- 子查询结果只执行一次，为不相关子查询
	- 子查询执行多次，每次都需要将关键字传入子查询，然后返回结果给主查询，为相关子查询

# 单行子查询
- 单行操作符
	- = != > >= < <=

# 多行子查询
- 多行操作符
	- IN: 等于返回值中任意一个
		<pre>
		SELECT employee_id, last_name
		FROM employees 
		WHERE salary IN (
						SELECT MIN(salary)
						FROM employees 
						GROUP BY department_id
						);
		</pre>
	- ANY: 和单行操作符一起使用。与子查询中的**某个**值比较
		<pre>
		SELECT employee_id, last_name
		FROM employees 
		WHERE job_id <> 'IT_PROG'
		AND salary < ANY (
						SELECT salary
						FROM employees 
						WHERE job_id = 'IT_PROG'
						);
		</pre>
	- ALL: 和单行操作符一起使用。和子查询中的**所有**值比较
		<pre>
		SELECT employee_id, last_name
		FROM employees 
		WHERE job_id <> 'IT_PROG'
		AND salary < ALL (
						SELECT salary
						FROM employees 
						WHERE job_id = 'IT_PROG'
						);
		</pre>
	- SOME: 与ANY相同

- 多行子查询作为临时表
	- 通过为子查询字段和结果赋别名来将其作为临时表，并可通过子查询的字段别名进行主查询
	<pre>
	SELECT MIN(avg_sal)
	FROM(
		SELECT AVG(salary) avg_sal
		FROM employees
		GROUP BY department_id
		) t_dept_avg_sal
	</pre>

# 相关子查询

# EXISTS
- 检查子查询是否满足要求
	- 如果不存在满足条件的行
		- 条件返回FALSE
		- 继续查找
	- 如果存在满足条件的行
		- 不继续查找
		- 条件返回TRUE

	<pre>
	SELECT employee_id, last_name, job_id, department_id
	FROM employees e1
	WHERE EXISTS (
				SELECT *
				FROM employees e2 
				WHERE e1.employee_id = e2.manager_id # 看e2中有没有e1(逐个)条目对应的记录，有就将e1的行加入查询结果
			)
	</pre>

# NOT EXISTS: 与EXISTS相反